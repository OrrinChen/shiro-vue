{"ast":null,"code":"export default {\n  name: \"Menu\",\n  data() {\n    return {\n      tableData: [],\n      total: 0,\n      pageNum: 1,\n      pageSize: 10,\n      name: \"\",\n      form: {\n        sortNum: 100\n      },\n      dialogFormVisible: false,\n      multipleSelection: [],\n      options: []\n    };\n  },\n  created() {\n    this.load();\n  },\n  methods: {\n    load() {\n      this.request.get(\"/menu\", {\n        params: {\n          name: this.name\n        }\n      }).then(res => {\n        this.tableData = res.data;\n      });\n\n      // 请求图标的数据\n      this.request.get(\"/menu/icons\").then(res => {\n        this.options = res.data;\n      });\n    },\n    save() {\n      this.request.post(\"/menu\", this.form).then(res => {\n        if (res.code === 200) {\n          this.$message.success(\"保存成功\");\n          this.dialogFormVisible = false;\n          this.load();\n        } else {\n          this.$message.error(\"保存失败\");\n        }\n      });\n    },\n    handleAdd(pid) {\n      this.dialogFormVisible = true;\n      this.form = {\n        sortNum: 100\n      };\n      if (pid) {\n        this.form.pid = pid;\n      }\n    },\n    handleEdit(row) {\n      this.form = JSON.parse(JSON.stringify(row));\n      this.dialogFormVisible = true;\n    },\n    del(id) {\n      this.request.delete(\"/menu/\" + id).then(res => {\n        if (res.code === 200) {\n          this.$message.success(\"删除成功\");\n          this.load();\n        } else {\n          this.$message.error(\"删除失败\");\n        }\n      });\n    },\n    handleSelectionChange(val) {\n      console.log(val);\n      this.multipleSelection = val;\n    },\n    delBatch() {\n      let ids = this.multipleSelection.map(v => v.id); // [{}, {}, {}] => [1,2,3]\n      if (ids.length === 0) {\n        this.$message.warning(\"请选择删除的菜单\");\n        return;\n      }\n      this.request.post(\"/menu/del/batch\", ids).then(res => {\n        if (res.code === 200) {\n          this.$message.success(\"批量删除成功\");\n          this.load();\n        } else {\n          this.$message.error(\"批量删除失败\");\n        }\n      });\n    },\n    reset() {\n      this.name = \"\";\n      this.load();\n    },\n    handleSizeChange(pageSize) {\n      console.log(pageSize);\n      this.pageSize = pageSize;\n      this.load();\n    },\n    handleCurrentChange(pageNum) {\n      console.log(pageNum);\n      this.pageNum = pageNum;\n      this.load();\n    },\n    exp() {\n      window.open(\"http://localhost:9090/role/export\");\n    },\n    handleExcelImportSuccess() {\n      this.$message.success(\"导入成功\");\n      this.load();\n    }\n  }\n};","map":{"version":3,"names":["name","data","tableData","total","pageNum","pageSize","form","sortNum","dialogFormVisible","multipleSelection","options","created","load","methods","request","get","params","then","res","save","post","code","$message","success","error","handleAdd","pid","handleEdit","row","JSON","parse","stringify","del","id","delete","handleSelectionChange","val","console","log","delBatch","ids","map","v","length","warning","reset","handleSizeChange","handleCurrentChange","exp","window","open","handleExcelImportSuccess"],"sources":["src/views/Menu.vue"],"sourcesContent":["<template>\n    <div>\n        <div style=\"margin: 10px 0\">\n            <el-input style=\"width: 200px\" placeholder=\"请输入名称\" suffix-icon=\"el-icon-search\" v-model=\"name\"></el-input>\n            <!--      <el-input style=\"width: 200px\" placeholder=\"请输入邮箱\" suffix-icon=\"el-icon-message\" class=\"ml-5\" v-model=\"email\"></el-input>-->\n            <!--      <el-input style=\"width: 200px\" placeholder=\"请输入地址\" suffix-icon=\"el-icon-position\" class=\"ml-5\" v-model=\"address\"></el-input>-->\n            <el-button class=\"ml-5\" type=\"primary\" @click=\"load\">搜索</el-button>\n            <el-button type=\"info\" @click=\"reset\">重置</el-button>\n        </div>\n\n        <div style=\"margin: 10px 0\">\n            <el-button type=\"primary\" @click=\"handleAdd(null)\">新增 <i class=\"el-icon-circle-plus-outline\"></i>\n            </el-button>\n            <el-popconfirm\n                    class=\"ml-5\"\n                    confirm-button-text='确定'\n                    cancel-button-text='我再想想'\n                    icon=\"el-icon-info\"\n                    icon-color=\"red\"\n                    title=\"您确定批量删除这些数据吗？\"\n                    @confirm=\"delBatch\"\n            >\n                <el-button type=\"danger\" slot=\"reference\">批量删除 <i class=\"el-icon-remove-outline\"></i></el-button>\n            </el-popconfirm>\n            <!--      <el-upload action=\"http://localhost:9090/user/import\" :show-file-list=\"false\" accept=\"xlsx\" :on-success=\"handleExcelImportSuccess\" style=\"display: inline-block\">-->\n            <!--        <el-button type=\"primary\" class=\"ml-5\">导入 <i class=\"el-icon-bottom\"></i></el-button>-->\n            <!--      </el-upload>-->\n            <!--      <el-button type=\"primary\" @click=\"exp\" class=\"ml-5\">导出 <i class=\"el-icon-top\"></i></el-button>-->\n        </div>\n\n        <el-table :data=\"tableData\" border stripe :header-cell-class-name=\"'headerBg'\"\n                  row-key=\"id\" default-expand-all @selection-change=\"handleSelectionChange\">\n            <el-table-column type=\"selection\" width=\"55\"></el-table-column>\n            <el-table-column prop=\"id\" label=\"ID\" width=\"80\"></el-table-column>\n            <el-table-column prop=\"name\" label=\"名称\"></el-table-column>\n            <el-table-column prop=\"path\" label=\"路径\"></el-table-column>\n            <el-table-column prop=\"pagePath\" label=\"页面路径\"></el-table-column>\n            <el-table-column label=\"图标\" class-name=\"fontSize18\" align=\"center\" label-class-name=\"fontSize12\">\n                <template slot-scope=\"scope\">\n                    <span :class=\"scope.row.icon\"/>\n                </template>\n            </el-table-column>\n            <el-table-column prop=\"description\" label=\"描述\"></el-table-column>\n            <el-table-column prop=\"sortNum\" label=\"顺序\"></el-table-column>\n            <el-table-column label=\"操作\" width=\"300\" align=\"center\">\n                <template slot-scope=\"scope\">\n                    <el-button type=\"primary\" @click=\"handleAdd(scope.row.id)\" v-if=\"!scope.row.pid && !scope.row.path\">\n                        新增子菜单 <i class=\"el-icon-plus\"></i></el-button>\n                    <el-button type=\"success\" @click=\"handleEdit(scope.row)\">编辑 <i class=\"el-icon-edit\"></i></el-button>\n                    <el-popconfirm\n                            class=\"ml-5\"\n                            confirm-button-text='确定'\n                            cancel-button-text='我再想想'\n                            icon=\"el-icon-info\"\n                            icon-color=\"red\"\n                            title=\"您确定删除吗？\"\n                            @confirm=\"del(scope.row.id)\"\n                    >\n                        <el-button type=\"danger\" slot=\"reference\">删除 <i class=\"el-icon-remove-outline\"></i></el-button>\n                    </el-popconfirm>\n                </template>\n            </el-table-column>\n        </el-table>\n\n        <el-dialog title=\"菜单信息\" :visible.sync=\"dialogFormVisible\" width=\"30%\">\n            <el-form label-width=\"80px\" size=\"small\">\n                <el-form-item label=\"名称\">\n                    <el-input v-model=\"form.name\" autocomplete=\"off\" placeholder=\"测试\"></el-input>\n                </el-form-item>\n                <el-form-item label=\"路径\">\n                    <el-input v-model=\"form.path\" autocomplete=\"off\" placeholder=\"/test\"></el-input>\n                </el-form-item>\n                <el-form-item label=\"页面路径\">\n                    <el-input v-model=\"form.pagePath\" autocomplete=\"off\" placeholder=\"Test\"></el-input>\n                </el-form-item>\n                <el-form-item label=\"图标\">\n                    <el-select clearable v-model=\"form.icon\" placeholder=\"请选择\" style=\"width: 100%\">\n                        <el-option v-for=\"item in options\" :key=\"item.name\" :label=\"item.name\" :value=\"item.value\">\n                            <i :class=\"item.value\"/> {{ item.name }}\n                        </el-option>\n                    </el-select>\n                </el-form-item>\n                <el-form-item label=\"权限\">\n                    <el-input placeholder=\"例如：user:add\" v-model=\"form.permission\" autocomplete=\"off\"></el-input>\n                </el-form-item>\n                <el-form-item label=\"顺序\">\n                    <el-input-number v-model=\"form.sortNum\" :min=\"1\" :max=\"999\" label=\"描述文字\"></el-input-number>\n                </el-form-item>\n                <el-form-item label=\"描述\">\n                    <el-input v-model=\"form.description\" autocomplete=\"off\"></el-input>\n                </el-form-item>\n            </el-form>\n            <div slot=\"footer\" class=\"dialog-footer\">\n                <el-button @click=\"dialogFormVisible = false\">取 消</el-button>\n                <el-button type=\"primary\" @click=\"save\">确 定</el-button>\n            </div>\n        </el-dialog>\n    </div>\n</template>\n\n<script>\n\n    export default {\n        name: \"Menu\",\n        data() {\n            return {\n                tableData: [],\n                total: 0,\n                pageNum: 1,\n                pageSize: 10,\n                name: \"\",\n                form: {\n                    sortNum:100,\n                },\n                dialogFormVisible: false,\n                multipleSelection: [],\n                options: []\n            }\n        },\n        created() {\n            this.load()\n        },\n        methods: {\n            load() {\n                this.request.get(\"/menu\", {\n                    params: {\n                        name: this.name,\n                    }\n                }).then(res => {\n                    this.tableData = res.data\n                })\n\n                // 请求图标的数据\n                this.request.get(\"/menu/icons\").then(res => {\n                    this.options = res.data\n                })\n            },\n            save() {\n                this.request.post(\"/menu\", this.form).then(res => {\n                    if (res.code === 200) {\n                        this.$message.success(\"保存成功\")\n                        this.dialogFormVisible = false\n                        this.load()\n                    } else {\n                        this.$message.error(\"保存失败\")\n                    }\n                })\n            },\n            handleAdd(pid) {\n                this.dialogFormVisible = true\n                this.form = {\n                    sortNum:100\n                }\n                if (pid) {\n                    this.form.pid = pid\n                }\n            },\n            handleEdit(row) {\n                this.form = JSON.parse(JSON.stringify(row))\n                this.dialogFormVisible = true\n            },\n            del(id) {\n                this.request.delete(\"/menu/\" + id).then(res => {\n                    if (res.code === 200) {\n                        this.$message.success(\"删除成功\")\n                        this.load()\n                    } else {\n                        this.$message.error(\"删除失败\")\n                    }\n                })\n            },\n            handleSelectionChange(val) {\n                console.log(val)\n                this.multipleSelection = val\n            },\n            delBatch() {\n                let ids = this.multipleSelection.map(v => v.id)  // [{}, {}, {}] => [1,2,3]\n                if (ids.length === 0) {\n                    this.$message.warning(\"请选择删除的菜单\")\n                    return\n                }\n                this.request.post(\"/menu/del/batch\", ids).then(res => {\n                    if (res.code === 200) {\n                        this.$message.success(\"批量删除成功\")\n                        this.load()\n                    } else {\n                        this.$message.error(\"批量删除失败\")\n                    }\n                })\n            },\n            reset() {\n                this.name = \"\"\n                this.load()\n            },\n            handleSizeChange(pageSize) {\n                console.log(pageSize)\n                this.pageSize = pageSize\n                this.load()\n            },\n            handleCurrentChange(pageNum) {\n                console.log(pageNum)\n                this.pageNum = pageNum\n                this.load()\n            },\n            exp() {\n                window.open(\"http://localhost:9090/role/export\")\n            },\n            handleExcelImportSuccess() {\n                this.$message.success(\"导入成功\")\n                this.load()\n            }\n        }\n    }\n</script>\n\n\n<style>\n    .headerBg {\n        background: #eee !important;\n    }\n\n    .fontSize18 {\n        font-size: 18px;\n    }\n\n    .fontSize12 {\n        font-size: 12px;\n    }\n</style>\n"],"mappings":"AAsGA;EACAA,IAAA;EACAC,KAAA;IACA;MACAC,SAAA;MACAC,KAAA;MACAC,OAAA;MACAC,QAAA;MACAL,IAAA;MACAM,IAAA;QACAC,OAAA;MACA;MACAC,iBAAA;MACAC,iBAAA;MACAC,OAAA;IACA;EACA;EACAC,QAAA;IACA,KAAAC,IAAA;EACA;EACAC,OAAA;IACAD,KAAA;MACA,KAAAE,OAAA,CAAAC,GAAA;QACAC,MAAA;UACAhB,IAAA,OAAAA;QACA;MACA,GAAAiB,IAAA,CAAAC,GAAA;QACA,KAAAhB,SAAA,GAAAgB,GAAA,CAAAjB,IAAA;MACA;;MAEA;MACA,KAAAa,OAAA,CAAAC,GAAA,gBAAAE,IAAA,CAAAC,GAAA;QACA,KAAAR,OAAA,GAAAQ,GAAA,CAAAjB,IAAA;MACA;IACA;IACAkB,KAAA;MACA,KAAAL,OAAA,CAAAM,IAAA,eAAAd,IAAA,EAAAW,IAAA,CAAAC,GAAA;QACA,IAAAA,GAAA,CAAAG,IAAA;UACA,KAAAC,QAAA,CAAAC,OAAA;UACA,KAAAf,iBAAA;UACA,KAAAI,IAAA;QACA;UACA,KAAAU,QAAA,CAAAE,KAAA;QACA;MACA;IACA;IACAC,UAAAC,GAAA;MACA,KAAAlB,iBAAA;MACA,KAAAF,IAAA;QACAC,OAAA;MACA;MACA,IAAAmB,GAAA;QACA,KAAApB,IAAA,CAAAoB,GAAA,GAAAA,GAAA;MACA;IACA;IACAC,WAAAC,GAAA;MACA,KAAAtB,IAAA,GAAAuB,IAAA,CAAAC,KAAA,CAAAD,IAAA,CAAAE,SAAA,CAAAH,GAAA;MACA,KAAApB,iBAAA;IACA;IACAwB,IAAAC,EAAA;MACA,KAAAnB,OAAA,CAAAoB,MAAA,YAAAD,EAAA,EAAAhB,IAAA,CAAAC,GAAA;QACA,IAAAA,GAAA,CAAAG,IAAA;UACA,KAAAC,QAAA,CAAAC,OAAA;UACA,KAAAX,IAAA;QACA;UACA,KAAAU,QAAA,CAAAE,KAAA;QACA;MACA;IACA;IACAW,sBAAAC,GAAA;MACAC,OAAA,CAAAC,GAAA,CAAAF,GAAA;MACA,KAAA3B,iBAAA,GAAA2B,GAAA;IACA;IACAG,SAAA;MACA,IAAAC,GAAA,QAAA/B,iBAAA,CAAAgC,GAAA,CAAAC,CAAA,IAAAA,CAAA,CAAAT,EAAA;MACA,IAAAO,GAAA,CAAAG,MAAA;QACA,KAAArB,QAAA,CAAAsB,OAAA;QACA;MACA;MACA,KAAA9B,OAAA,CAAAM,IAAA,oBAAAoB,GAAA,EAAAvB,IAAA,CAAAC,GAAA;QACA,IAAAA,GAAA,CAAAG,IAAA;UACA,KAAAC,QAAA,CAAAC,OAAA;UACA,KAAAX,IAAA;QACA;UACA,KAAAU,QAAA,CAAAE,KAAA;QACA;MACA;IACA;IACAqB,MAAA;MACA,KAAA7C,IAAA;MACA,KAAAY,IAAA;IACA;IACAkC,iBAAAzC,QAAA;MACAgC,OAAA,CAAAC,GAAA,CAAAjC,QAAA;MACA,KAAAA,QAAA,GAAAA,QAAA;MACA,KAAAO,IAAA;IACA;IACAmC,oBAAA3C,OAAA;MACAiC,OAAA,CAAAC,GAAA,CAAAlC,OAAA;MACA,KAAAA,OAAA,GAAAA,OAAA;MACA,KAAAQ,IAAA;IACA;IACAoC,IAAA;MACAC,MAAA,CAAAC,IAAA;IACA;IACAC,yBAAA;MACA,KAAA7B,QAAA,CAAAC,OAAA;MACA,KAAAX,IAAA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}