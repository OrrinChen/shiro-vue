{"ast":null,"code":"import orderInfoApi from \"../api/orderInfo\";\nimport wxPayApi from \"../api/wxPay\";\nexport default {\n  data() {\n    return {\n      list: [],\n      //订单列表\n      refundDialogVisible: false,\n      //退款弹窗\n      orderNo: '',\n      //退款订单号\n      reason: '',\n      //退款原因,\n      refundSubmitBtnDisabled: false //防止重复提交\n    };\n  },\n\n  created() {\n    this.showOrderList();\n  },\n  methods: {\n    //显示订单列表\n    showOrderList() {\n      orderInfoApi.list().then(response => {\n        this.list = response.data.list;\n      });\n    },\n    //用户取消订单\n    cancel(orderNo) {\n      wxPayApi.cancel(orderNo).then(response => {\n        this.$message.success(response.message);\n        //刷新订单列表\n        this.showOrderList();\n      });\n    },\n    //退款对话框\n    refund(orderNo) {\n      this.refundDialogVisible = true;\n      this.orderNo = orderNo;\n    },\n    //关闭退款对话框\n    closeDialog() {\n      console.log('close.................');\n      this.refundDialogVisible = false;\n      //还原组件状态\n      this.orderNo = '';\n      this.reason = '';\n      this.refundSubmitBtnDisabled = false;\n    },\n    //确认退款\n    toRefunds() {\n      this.refundSubmitBtnDisabled = true; //禁用按钮，防止重复提交\n      wxPayApi.refunds(this.orderNo, this.reason).then(response => {\n        console.log('response', response);\n        this.closeDialog();\n        this.showOrderList();\n      });\n    }\n  }\n};","map":{"version":3,"names":["orderInfoApi","wxPayApi","data","list","refundDialogVisible","orderNo","reason","refundSubmitBtnDisabled","created","showOrderList","methods","then","response","cancel","$message","success","message","refund","closeDialog","console","log","toRefunds","refunds"],"sources":["src/views/Orders.vue"],"sourcesContent":["<template>\r\n  <div class=\"bg-fa of\">\r\n    <section id=\"index\" class=\"container\">\r\n      <header class=\"comm-title\">\r\n        <h2 class=\"fl tac\">\r\n          <span class=\"c-333\">订单列表</span>\r\n        </h2>\r\n      </header>\r\n      <el-table :data=\"list\" border style=\"width: 100%\">\r\n        <el-table-column type=\"index\" width=\"50\"></el-table-column>\r\n        <el-table-column prop=\"orderNo\" label=\"订单编号\" width=\"230\" ></el-table-column>\r\n        <el-table-column prop=\"title\" label=\"订单标题\"></el-table-column>\r\n        <el-table-column prop=\"totalFee\" label=\"订单金额\">\r\n          <template slot-scope=\"scope\">\r\n              {{scope.row.totalFee / 100}} 元\r\n          </template>  \r\n        </el-table-column>\r\n        <el-table-column label=\"订单状态\">\r\n          <template slot-scope=\"scope\">\r\n            <el-tag v-if=\"scope.row.orderStatus === '未支付'\">\r\n              {{scope.row.orderStatus}}\r\n            </el-tag>\r\n            <el-tag v-if=\"scope.row.orderStatus === '支付成功'\" type=\"success\">\r\n              {{ scope.row.orderStatus }}\r\n            </el-tag>\r\n            <el-tag v-if=\"scope.row.orderStatus === '超时已关闭'\" type=\"warning\">\r\n              {{scope.row.orderStatus}}\r\n            </el-tag>\r\n            <el-tag v-if=\"scope.row.orderStatus === '用户已取消'\" type=\"info\">\r\n              {{scope.row.orderStatus}}\r\n            </el-tag>\r\n            <el-tag v-if=\"scope.row.orderStatus === '退款中'\" type=\"danger\">\r\n              {{scope.row.orderStatus}}\r\n            </el-tag>\r\n            <el-tag v-if=\"scope.row.orderStatus === '已退款'\" type=\"info\">\r\n              {{scope.row.orderStatus}}\r\n            </el-tag>\r\n          </template>\r\n        </el-table-column>\r\n        <!-- <el-table-column prop=\"createTime\" label=\"创建时间\"></el-table-column> -->\r\n        <el-table-column label=\"操作\" width=\"100\" align=\"center\">\r\n          <template slot-scope=\"scope\">\r\n            <el-button v-if=\"scope.row.orderStatus === '未支付'\" type=\"text\" @click=\"cancel(scope.row.orderNo)\">取消</el-button>\r\n            <el-button v-if=\"scope.row.orderStatus === '支付成功'\" type=\"text\" @click=\"refund(scope.row.orderNo)\">退款</el-button>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n    </section>\r\n\r\n    <!-- 退款对话框 -->\r\n   <el-dialog\r\n      :visible.sync=\"refundDialogVisible\"\r\n      @close=\"closeDialog\"\r\n      width=\"350px\"\r\n      center>\r\n      <el-form>\r\n        <el-form-item label=\"退款原因\">\r\n          <el-select v-model=\"reason\" placeholder=\"请选择退款原因\">\r\n            <el-option label=\"不喜欢\" value=\"不喜欢\"></el-option>\r\n            <el-option label=\"买错了\" value=\"买错了\"></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n      </el-form>\r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button type=\"primary\" @click=\"toRefunds()\" :disabled=\"refundSubmitBtnDisabled\">确 定</el-button>\r\n      </div>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport orderInfoApi from \"../api/orderInfo\"\r\nimport wxPayApi from \"../api/wxPay\"\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      list: [], //订单列表\r\n      refundDialogVisible: false, //退款弹窗\r\n      orderNo: '', //退款订单号\r\n      reason: '', //退款原因,\r\n      refundSubmitBtnDisabled: false, //防止重复提交\r\n    };\r\n  },\r\n\r\n  created() {\r\n    this.showOrderList()\r\n  },\r\n\r\n  methods: {\r\n\r\n    //显示订单列表\r\n    showOrderList(){\r\n      orderInfoApi.list().then((response) => {\r\n        this.list = response.data.list;\r\n      });\r\n    },\r\n    \r\n    //用户取消订单\r\n    cancel(orderNo){\r\n      wxPayApi.cancel(orderNo).then(response => {\r\n        this.$message.success(response.message)\r\n        //刷新订单列表\r\n        this.showOrderList()\r\n      })\r\n    },\r\n\r\n    //退款对话框\r\n    refund(orderNo){\r\n      this.refundDialogVisible = true\r\n      this.orderNo = orderNo\r\n    },\r\n\r\n    //关闭退款对话框\r\n    closeDialog(){\r\n      console.log('close.................')\r\n      this.refundDialogVisible = false\r\n      //还原组件状态\r\n      this.orderNo = ''\r\n      this.reason = ''\r\n      this.refundSubmitBtnDisabled = false\r\n    },\r\n\r\n    //确认退款\r\n    toRefunds(){\r\n      this.refundSubmitBtnDisabled = true //禁用按钮，防止重复提交\r\n      wxPayApi.refunds(this.orderNo, this.reason).then(response => {\r\n        console.log('response', response)\r\n        this.closeDialog()\r\n        this.showOrderList()\r\n      })\r\n    }\r\n  }\r\n};\r\n</script>"],"mappings":"AAuEA,OAAAA,YAAA;AACA,OAAAC,QAAA;AAEA;EACAC,KAAA;IACA;MACAC,IAAA;MAAA;MACAC,mBAAA;MAAA;MACAC,OAAA;MAAA;MACAC,MAAA;MAAA;MACAC,uBAAA;IACA;EACA;;EAEAC,QAAA;IACA,KAAAC,aAAA;EACA;EAEAC,OAAA;IAEA;IACAD,cAAA;MACAT,YAAA,CAAAG,IAAA,GAAAQ,IAAA,CAAAC,QAAA;QACA,KAAAT,IAAA,GAAAS,QAAA,CAAAV,IAAA,CAAAC,IAAA;MACA;IACA;IAEA;IACAU,OAAAR,OAAA;MACAJ,QAAA,CAAAY,MAAA,CAAAR,OAAA,EAAAM,IAAA,CAAAC,QAAA;QACA,KAAAE,QAAA,CAAAC,OAAA,CAAAH,QAAA,CAAAI,OAAA;QACA;QACA,KAAAP,aAAA;MACA;IACA;IAEA;IACAQ,OAAAZ,OAAA;MACA,KAAAD,mBAAA;MACA,KAAAC,OAAA,GAAAA,OAAA;IACA;IAEA;IACAa,YAAA;MACAC,OAAA,CAAAC,GAAA;MACA,KAAAhB,mBAAA;MACA;MACA,KAAAC,OAAA;MACA,KAAAC,MAAA;MACA,KAAAC,uBAAA;IACA;IAEA;IACAc,UAAA;MACA,KAAAd,uBAAA;MACAN,QAAA,CAAAqB,OAAA,MAAAjB,OAAA,OAAAC,MAAA,EAAAK,IAAA,CAAAC,QAAA;QACAO,OAAA,CAAAC,GAAA,aAAAR,QAAA;QACA,KAAAM,WAAA;QACA,KAAAT,aAAA;MACA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}